<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archivo Digital del Carnaval de C&aacute;diz</title>
    <meta name="description" content="Archivo digital de letras del Carnaval de C&aacute;diz. Buscador, estad&iacute;sticas y base de datos de comparsas, chirigotas, coros y cuartetos.">
    <meta property="og:title" content="Archivo Digital del Carnaval de C&aacute;diz">
    <meta property="og:description" content="La mayor base de datos de letras del Carnaval de C&aacute;diz">
    <meta property="og:type" content="website">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>

<!-- HEADER -->
<header class="main-header">
    <div class="header-content">
        <h1 class="logo">Archivo del Carnaval de C&aacute;diz</h1>
        <p class="subtitle">Base de datos de letras &middot; Comparsas, Chirigotas, Coros y Cuartetos</p>
    </div>
</header>

<!-- STATS BAR -->
<section class="stats-bar" id="statsBar">
    <div class="stat-item">
        <span class="stat-number" id="statTotal">--</span>
        <span class="stat-label">Letras</span>
    </div>
    <div class="stat-item">
        <span class="stat-number" id="statAnios">--</span>
        <span class="stat-label">A&ntilde;os</span>
    </div>
    <div class="stat-item">
        <span class="stat-number" id="statModalidades">--</span>
        <span class="stat-label">Modalidades</span>
    </div>
    <div class="stat-item">
        <span class="stat-number" id="statAgrupaciones">--</span>
        <span class="stat-label">Agrupaciones</span>
    </div>
</section>

<!-- TABS -->
<nav class="tabs">
    <button class="tab active" data-tab="buscar" onclick="switchTab('buscar')">Buscar</button>
    <button class="tab" data-tab="explorar" onclick="switchTab('explorar')">Explorar</button>
    <button class="tab" data-tab="descubrir" onclick="switchTab('descubrir')">Descubrir</button>
    <button class="tab" data-tab="cronologia" onclick="switchTab('cronologia')">Cronolog&iacute;a</button>
    <button class="tab" data-tab="comparar" onclick="switchTab('comparar')">Comparar</button>
    <button class="tab" data-tab="estadisticas" onclick="switchTab('estadisticas')">Estad&iacute;sticas</button>
    <button class="tab" data-tab="poetica" onclick="switchTab('poetica')">Po&eacute;tica</button>
</nav>

<!-- TAB: BUSCAR -->
<section class="tab-content active" id="tab-buscar">
    <div class="search-box">
        <input type="text" id="buscadorFTS" placeholder="Buscar en todas las letras... (ej: 'nostalgia', 'cadiz', 'critica politica')" autocomplete="off">
        <button onclick="buscarFullText()" class="btn-primary">Buscar</button>
    </div>
    <div class="tematicas-bar" id="tematicasBar">
        <span class="tematica-label">Tematicas:</span>
        <button class="tag-btn" onclick="buscarTematica('nostalgia')">Nostalgia</button>
        <button class="tag-btn" onclick="buscarTematica('politica')">Pol&iacute;tica</button>
        <button class="tag-btn" onclick="buscarTematica('amor')">Amor</button>
        <button class="tag-btn" onclick="buscarTematica('cadiz')">C&aacute;diz</button>
        <button class="tag-btn" onclick="buscarTematica('mar')">Mar</button>
        <button class="tag-btn" onclick="buscarTematica('madre')">Madre</button>
        <button class="tag-btn" onclick="buscarTematica('carnaval')">Carnaval</button>
        <button class="tag-btn" onclick="buscarTematica('libertad')">Libertad</button>
        <button class="tag-btn" onclick="buscarTematica('humor')">Humor</button>
    </div>
    <div id="resultadosBusqueda" class="resultados-lista"></div>
</section>

<!-- TAB: EXPLORAR -->
<section class="tab-content" id="tab-explorar">
    <div class="filtros-bar">
        <select id="filtroAnio"><option value="">Todos los a&ntilde;os</option></select>
        <select id="filtroModalidad"><option value="">Todas las modalidades</option></select>
        <select id="filtroTipo"><option value="">Todos los tipos</option></select>
        <input type="text" id="filtroAgrupacion" placeholder="Buscar agrupaci&oacute;n...">
        <button onclick="aplicarFiltros()" class="btn-primary">Filtrar</button>
        <button onclick="limpiarFiltros()" class="btn-secondary">Limpiar</button>
    </div>

    <div class="info-bar" id="infoBar">
        <span id="totalResultados">--</span>
        <span id="paginaInfo"></span>
    </div>

    <div id="lista" class="letras-grid"></div>

    <div class="paginacion" id="paginacion"></div>
</section>

<!-- TAB: DESCUBRIR -->
<section class="tab-content" id="tab-descubrir">
    <div class="descubrir-layout">
        <!-- LETRA ALEATORIA -->
        <div class="descubrir-aleatorio">
            <h3>Letra aleatoria</h3>
            <p class="text-muted">Descubre letras al azar del archivo</p>
            <div class="aleatorio-filtros">
                <select id="aleatorioModalidad">
                    <option value="">Cualquier modalidad</option>
                    <option value="Comparsa">Comparsa</option>
                    <option value="Chirigota">Chirigota</option>
                    <option value="Coro">Coro</option>
                </select>
                <button onclick="letraAleatoria()" class="btn-primary btn-aleatorio">Sorpr&eacute;ndeme</button>
            </div>
            <div id="aleatorioResultado" class="aleatorio-card"></div>
        </div>

        <!-- NUBE DE PALABRAS -->
        <div class="descubrir-nube">
            <h3>Palabras m&aacute;s usadas</h3>
            <p class="text-muted">An&aacute;lisis de frecuencia del vocabulario carnavalesco</p>
            <div class="nube-filtros">
                <select id="nubeModalidad" onchange="cargarNubePalabras()">
                    <option value="">Todas las modalidades</option>
                    <option value="Comparsa">Comparsa</option>
                    <option value="Chirigota">Chirigota</option>
                    <option value="Coro">Coro</option>
                </select>
            </div>
            <div id="nubePalabras" class="nube-container"></div>
        </div>
    </div>
</section>

<!-- TAB: CRONOLOGIA -->
<section class="tab-content" id="tab-cronologia">
    <div class="cronologia-header">
        <h3>Cronolog&iacute;a del Carnaval de C&aacute;diz</h3>
        <p class="text-muted">Recorrido hist&oacute;rico por a&ntilde;os con las agrupaciones m&aacute;s destacadas</p>
    </div>
    <div id="timelineContainer" class="timeline-container"></div>
</section>

<!-- TAB: COMPARAR -->
<section class="tab-content" id="tab-comparar">
    <div class="comparar-box">
        <h3>Comparar agrupaciones</h3>
        <p class="text-muted">Compara estad&iacute;sticas y estilos entre dos agrupaciones del Carnaval</p>
        <div class="comparar-inputs">
            <input type="text" id="comp1" placeholder="Agrupaci&oacute;n 1 (ej: Los carapapas)">
            <span class="vs-label">VS</span>
            <input type="text" id="comp2" placeholder="Agrupaci&oacute;n 2 (ej: Los blandengues)">
            <button onclick="compararEstilos()" class="btn-primary">Comparar</button>
        </div>
    </div>
    <div id="resultadoComparar"></div>
</section>

<!-- TAB: ESTADISTICAS -->
<section class="tab-content" id="tab-estadisticas">
    <div class="charts-grid">
        <div class="chart-card">
            <h3>Letras por a&ntilde;o</h3>
            <div id="chartAnios" class="chart-bars"></div>
        </div>
        <div class="chart-card">
            <h3>Por modalidad</h3>
            <div id="chartModalidad" class="chart-bars"></div>
        </div>
        <div class="chart-card">
            <h3>Por tipo de pieza</h3>
            <div id="chartTipo" class="chart-bars"></div>
        </div>
        <div class="chart-card">
            <h3>Top 15 agrupaciones</h3>
            <div id="chartAgrupaciones" class="chart-bars"></div>
        </div>
        <div class="chart-card">
            <h3>Top autores</h3>
            <div id="chartAutores" class="chart-bars"></div>
        </div>
        <div class="chart-card">
            <h3>Calidad del archivo</h3>
            <div id="chartCalidad" class="chart-bars"></div>
        </div>
    </div>
</section>

<!-- TAB: POÉTICA -->
<section class="tab-content" id="tab-poetica">
    <div class="poetica-header">
        <h3>An&aacute;lisis Po&eacute;tico del Carnaval</h3>
        <p class="text-muted">M&eacute;trica, rima, figuras ret&oacute;ricas y vocabulario gaditano del corpus carnavalesco</p>
    </div>

    <!-- FILTROS DEL CORPUS -->
    <div class="poetica-filtros filtros-bar">
        <select id="poeticaModalidad">
            <option value="">Todas las modalidades</option>
            <option value="Comparsa">Comparsa</option>
            <option value="Chirigota">Chirigota</option>
            <option value="Coro">Coro</option>
            <option value="Cuarteto">Cuarteto</option>
        </select>
        <select id="poeticaAnio">
            <option value="">Todos los a&ntilde;os</option>
        </select>
        <select id="poeticaTipo">
            <option value="">Todos los tipos</option>
            <option value="Pasodoble">Pasodoble</option>
            <option value="Cupl&eacute;">Cupl&eacute;</option>
            <option value="Tango">Tango</option>
            <option value="Popurr&iacute;">Popurr&iacute;</option>
            <option value="Presentaci&oacute;n">Presentaci&oacute;n</option>
        </select>
        <button onclick="cargarPoética()" class="btn-primary">Analizar corpus</button>
        <span class="poetica-aviso" id="poeticaAviso"></span>
    </div>

    <div id="poeticaLoader" class="loader-text" style="display:none">Analizando... puede tardar unos segundos.</div>

    <!-- DASHBOARD POÉTICO -->
    <div id="poeticaDashboard" style="display:none">

        <!-- MÉTRICAS RÁPIDAS -->
        <div class="poetica-kpis" id="poeticaKpis"></div>

        <!-- GRID DE CHARTS -->
        <div class="charts-grid" id="poeticaCharts">
            <div class="chart-card">
                <h3>Metros dom&iacute;nantes</h3>
                <p class="text-muted-sm">Tipo de verso m&aacute;s usado en cada letra</p>
                <div id="chartMetros" class="chart-bars"></div>
            </div>
            <div class="chart-card">
                <h3>Tipo de rima</h3>
                <p class="text-muted-sm">Consonante, asonante o libre</p>
                <div id="chartRima" class="chart-bars"></div>
            </div>
            <div class="chart-card">
                <h3>Esquemas m&aacute;s frecuentes</h3>
                <p class="text-muted-sm">Patrones de rima (ABAB, ABBA...)</p>
                <div id="chartEsquemas" class="chart-bars"></div>
            </div>
            <div class="chart-card">
                <h3>Figuras ret&oacute;ricas</h3>
                <p class="text-muted-sm">An&aacute;fora, ep&iacute;fora, enumeraci&oacute;n...</p>
                <div id="chartFiguras" class="chart-bars"></div>
            </div>
            <div class="chart-card">
                <h3>L&eacute;xico gaditano</h3>
                <p class="text-muted-sm">Palabras del habla y cultura de C&aacute;diz</p>
                <div id="chartLexico" class="nube-container" style="max-height:220px;overflow:hidden"></div>
            </div>
            <div class="chart-card">
                <h3>Palabras clave del corpus</h3>
                <p class="text-muted-sm">T&eacute;rminos m&aacute;s significativos</p>
                <div id="chartPalabrasClave" class="nube-container" style="max-height:220px;overflow:hidden"></div>
            </div>
        </div>

    </div>

    <!-- ANÁLISIS INDIVIDUAL (desde modal) -->
    <div class="poetica-individual-section">
        <h4>Analizar una letra concreta</h4>
        <p class="text-muted">Busca una letra y haz clic en <strong>Ver an&aacute;lisis po&eacute;tico</strong> desde el detalle de la letra.</p>
    </div>
</section>

<!-- MODAL DETALLE -->
<div class="modal-overlay" id="modalOverlay" onclick="cerrarModal()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <button class="modal-close" onclick="cerrarModal()">&times;</button>
        <div id="detalle"></div>
    </div>
</div>

<!-- MODAL ANÁLISIS POÉTICO -->
<div class="modal-overlay" id="modalPoetaOverlay" onclick="cerrarModalPoeta()">
    <div class="modal-content modal-poetico" onclick="event.stopPropagation()">
        <button class="modal-close" onclick="cerrarModalPoeta()">&times;</button>
        <div id="detallePoeta"></div>
    </div>
</div>

<!-- FOOTER -->
<footer class="main-footer">
    <div class="footer-creditos">
        <p><strong>Archivo Digital del Carnaval de C&aacute;diz</strong></p>
        <p>Transcripci&oacute;n realizada por <a href="https://letrasdesdeelparaiso.blogspot.com/" target="_blank" rel="noopener">Letras Desde el Para&iacute;so</a></p>
        <p class="legal">&copy; 2026. Prohibida su reproducci&oacute;n &iacute;ntegra sin autorizaci&oacute;n.<br>Para citar, incluya enlace directo a la publicaci&oacute;n original.</p>
    </div>
    <p class="footer-links">
        <a href="/admin">Panel Admin</a> &middot;
        <a href="/api/estadisticas" target="_blank">API</a> &middot;
        <a href="/api/creditos" target="_blank">Cr&eacute;ditos</a>
    </p>
</footer>

<script src="/static/js/app.js"></script>
</body>
</html>
